-- PROFTPD-MIB { iso org(3) dod(6) internet(1) private(4) enterprises(1) 17852 }

PROFTPD-MIB DEFINITIONS ::= BEGIN
--
-- $Id$
--

IMPORTS
        enterprises, Integer32, Unsigned32, TimeTicks, Gauge32, Counter32,
        MODULE-IDENTITY, NOTIFICATION-TYPE, OBJECT-TYPE
                FROM SNMPv2-SMI

        DisplayString
                FROM SNMPv2-TC;

proftpd OBJECT IDENTIFIER ::= { enterprises 17852 }
modules OBJECT IDENTIFIER ::= { proftpd 2 }

snmpModule MODULE-IDENTITY
    LAST-UPDATED "1110130000Z"
    ORGANIZATION "The ProFTPD Project"
    CONTACT-INFO
            "       ProFTPD Project 

             E-mail: core@proftpd.org"
    DESCRIPTION
                "ProFTPD MIB defined for the monitoring of the ProFTPD
                file transfer server. See http://www.proftpd.org/."

    ::= { modules 2 }

--
-- OID Assignments
--
        connection      OBJECT IDENTIFIER ::= { snmpModule 0 }

        daemon          OBJECT IDENTIFIER ::= { snmpModule 1 }
        notifications   OBJECT IDENTIFIER ::= { daemon 1 }

        ftp             OBJECT IDENTIFIER ::= { snmpModule 2 }
        sessions        OBJECT IDENTIFIER ::= { ftp 1 }
        logins          OBJECT IDENTIFIER ::= { ftp 2 }
        dataTransfers   OBJECT IDENTIFIER ::= { ftp 3 }
        timeouts        OBJECT IDENTIFIER ::= { ftp 4 }
        notifications   OBJECT IDENTIFIER ::= { ftp 5 }

        snmp            OBJECT IDENTIFIER ::= { snmpModule 3 }

--
-- connection arc
--
        serverName OBJECT-TYPE
            SYNTAX DisplayString
            MAX-ACCESS accessible-for-notify
            STATUS current
            DESCRIPTION
                " ServerName of server to which client connected "
        ::= { connection 1 }

        serverAddress OBJECT-TYPE
            SYNTAX DisplayString
            MAX-ACCESS accessible-for-notify
            STATUS current
            DESCRIPTION
                " IP address of server to which client connected "
        ::= { connection 2 }

        serverPort OBJECT-TYPE
            SYNTAX Integer32
            MAX-ACCESS accessible-for-notify
            STATUS current
            DESCRIPTION
                " Port of server to which client connected "
        ::= { connection 3 }

        clientAddress OBJECT-TYPE
            SYNTAX DisplayString
            MAX-ACCESS accessible-for-notify
            STATUS current
            DESCRIPTION
                " IP address of connected client "
        ::= { connection 4 }

        processId OBJECT-TYPE
            SYNTAX Integer32
            MAX-ACCESS accessible-for-notify
            STATUS current
            DESCRIPTION
                " ID of process handling the client/server connection "
        ::= { connection 5 }

        userName OBJECT-TYPE
            SYNTAX DisplayString
            MAX-ACCESS accessible-for-notify
            STATUS current
            DESCRIPTION
                " User name for connecting client "
        ::= { connection 6 }

        protocol OBJECT-TYPE
            SYNTAX DisplayString
            MAX-ACCESS accessible-for-notify
            STATUS current
            DESCRIPTION
                " Protocol in use by the client to the server "
        ::= { connection 7 }

--
-- daemon arc
--
        software OBJECT-TYPE
            SYNTAX DisplayString
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Server software name "
        ::= { daemon 1 }

        softwareVersion OBJECT-TYPE
            SYNTAX DisplayString
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Server software version "
        ::= { daemon 2 }

        admin OBJECT-TYPE
            SYNTAX DisplayString
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Server administrator email address "
        ::= { daemon 3 }

        uptime OBJECT-TYPE
            SYNTAX TimeTicks
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " The uptime of the proftpd daemon in timeticks "
        ::= { daemon 4 }

        vhostCount OBJECT-TYPE
            SYNTAX Integer32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Count of configured virtual hosts "
        ::= { daemon 5 }

        connectionCount OBJECT-TYPE
            SYNTAX Gauge32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Count of currently connected clients "
        ::= { daemon 6 }

        connectionTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of connections from clients "
        ::= { daemon 7 }

        connectionRefusedTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of refused connections from clients "
        ::= { daemon 8 }

        restartCount OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of times the server has been restarted "
        ::= { daemon 9 }

        segfaultCount OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of segfaults seen by connected sessions "
        ::= { daemon 10 }

        maxInstancesLimitCount OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of times the MaxInstances limit has been reached "
        ::= { daemon 11 }

--
-- daemon.notifications arc
--

--
-- ftp arc
--

--
-- ftp.sessions arc
--
        sessionCount OBJECT-TYPE
            SYNTAX Gauge32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Count of current FTP sessions "
        ::= { sessions 1 }

        sessionTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of FTP sessions "
        ::= { sessions 2 }

        commandInvalidTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of invalid FTP commands seen "
        ::= { sessions 3 }

--
-- ftp.logins arc
--
        loginTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of successful FTP logins "
        ::= { logins 1 }

        loginFailedTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of failed FTP logins "
        ::= { logins 2 }

        loginBadUserTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of failed FTP logins due to unknown user "
        ::= { logins 3 }

        loginBadPasswordTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of failed FTP logins due to bad/wrong password "
        ::= { logins 4 }

        loginGeneralErrorTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of failed FTP logins due to config/other issues "
        ::= { logins 5 }

        anonLoginCount OBJECT-TYPE
            SYNTAX Gauge32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Count of current anonymous FTP logins "
        ::= { logins 6 }

        anonLoginTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of anonymous FTP logins "
        ::= { logins 7 }

--
-- ftp.dataTransfers arc
--
        dirListCount OBJECT-TYPE
            SYNTAX Gauge32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Count of directories being listed via FTP "
        ::= { dataTransfers 1 }

        dirListTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of directories successfully listed via FTP "
        ::= { dataTransfers 2 }

        dirListFailedTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of directory list failures via FTP "
        ::= { dataTransfers 3 }

        fileUploadCount OBJECT-TYPE
            SYNTAX Gauge32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Count of files being uploaded via FTP "
        ::= { dataTransfers 4 }

        fileUploadTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of files uploaded successfully via FTP "
        ::= { dataTransfers 5 }

        fileUploadFailedTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of file upload failures via FTP "
        ::= { dataTransfers 6 }

        fileDownloadCount OBJECT-TYPE
            SYNTAX Gauge32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Count of directories being listed via FTP "
        ::= { dataTransfers 7 }

        fileDownloadTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of files downloaded successfully via FTP "
        ::= { dataTransfers 8 }

        fileDownloadFailedTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of file download failures via FTP "
        ::= { dataTransfers 9 }

        kbUploadTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of KB uploaded via FTP "
        ::= { dataTransfers 10 }

        kbDownloadTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of KB downloaded via FTP "
        ::= { dataTransfers 11 }

--
-- ftp.timeouts arc
--
        idleTimeoutTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of times TimeoutIdle was reached "
        ::= { timeouts 1 }

        loginTimeoutTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of times TimeoutLogin was reached "
        ::= { timeouts 2 }

        noTransferTimeoutTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of times TimeoutNoTransfer was reached "
        ::= { timeouts 3 }

        stalledTimeoutTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of times TimeoutStalled was reached "
        ::= { timeouts 4 }

--
-- ftp.notifications arc
--
        loginFailedBadPassword NOTIFICATION-TYPE
            OBJECTS { serverName,
                      serverAddress,
                      serverPort,
                      clientAddress,
                      processId,
                      userName,
                      protocol }
            STATUS  current
            DESCRIPTION
                " Notification of a client using a bad password "
        ::= { notifications 1 }

        loginFailedBadUser NOTIFICATION-TYPE
            OBJECTS { serverName,
                      serverAddress,
                      serverPort,
                      clientAddress,
                      processId,
                      userName,
                      protocol }
            STATUS  current
            DESCRIPTION
                " Notification of a client using a bad/unknown user name "
        ::= { notifications 2 }

--      maxLoginAttemptsExceeded
--      loginFailedMaxClientsExceeded
--      loginFailedMaxClientsPerClassExceeded
--      loginFailedMaxClientsPerHostExceeded
--      loginFailedMaxClientsPerUserExceeded
--      loginFailedMaxHostsPerUserExceeded

--
-- snmp arc
--
        packetsReceivedTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of SNMP packets received "
        ::= { snmp 1 }

        packetsSentTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of SNMP packets sent "
        ::= { snmp 2 }

        trapsSentTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of SNMP traps/notifications sent "
        ::= { snmp 3 }

        packetsAuthFailedTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of SNMP packets failing authentication check "
        ::= { snmp 4 }

        packetsDroppedTotal OBJECT-TYPE
            SYNTAX Counter32
            MAX-ACCESS read-only
            STATUS current
            DESCRIPTION
                " Total number of SNMP packets dropped "
        ::= { snmp 5 }

-- end of PROFTPD-MIB
--
END

